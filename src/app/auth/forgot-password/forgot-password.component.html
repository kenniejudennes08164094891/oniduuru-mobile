<body>
  <ion-content class="h-screen [--background:transparent] p-0">
    <ion-grid class="h-full grid grid-rows-4 bg-transparent float-left w-full">
      <ion-row class="flex justify-center items-center bg-transparent">
        <ion-col class="text-white text-center"></ion-col>
      </ion-row>

      <ion-row class="flex justify-center items-center bg-transparent">
        <ion-col class="text-white text-center">
          <form class="max-w-sm mx-auto" (ngSubmit)="onSubmit()">
            <!-- Step 1: Account Type Selection -->
            <div *ngIf="currentStep === 1" class="w-full max-w-md">
              <div
                class="bg-white text-left rounded-xl p-6 shadow-lg mx-auto text-black"
              >
                <h2 class="text-[28px] text-[#101828] font-semibold mb-2">
                  Validate User's Data
                </h2>
                <p class="text-[16px] text-[#101828] mb-6">
                  Select account type
                </p>

                <div class="flex items-center justify-between mb-8">
                  <div class="flex items-center gap-3">
                    <input
                      type="radio"
                      class="text-[#CC0000] text-[24px]"
                      name="accountType"
                      value="talent"
                      [(ngModel)]="forgotPasswordData.accountType"
                      required
                    />
                    <label class="text-[18px] text-[#101828]"
                      >I'm a Talent</label
                    >
                  </div>
                  <div class="flex items-center gap-3">
                    <input
                      type="radio"
                      class="text-[#CC0000] text-[24px]"
                      name="accountType"
                      value="scouter"
                      [(ngModel)]="forgotPasswordData.accountType"
                      required
                    />
                    <label class="text-[18px] text-[#101828]"
                      >I'm a Scouter</label
                    >
                  </div>
                </div>

                <button
                  type="button"
                  (click)="nextStep()"
                  [disabled]="!forgotPasswordData.accountType"
                  [class]="
                    forgotPasswordData.accountType
                      ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full mb-3 cursor-pointer'
                      : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full mb-3 cursor-not-allowed'
                  "
                >
                  Submit
                </button>
                <button
                  type="button"
                  (click)="goBack()"
                  class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                >
                  Route Back
                </button>
              </div>
            </div>

            <!-- Step 2: Security Questions -->
            <div *ngIf="currentStep === 2" class="w-full max-w-md">
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <h2
                  class="text-[28px] text-[#101828] text-start font-semibold mb-2"
                >
                  Validate User's Data
                </h2>
                <p class="text-[16px] text-[#101828] mb-6 text-start">
                  Answer your security question
                </p>

                <div class="space-y-6">
                  <div class="space-y-6">
                    <input
                      type="text"
                      placeholder="Input Unique Identifier"
                      class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                      [(ngModel)]="forgotPasswordData.identifier"
                      name="identifier"
                      required
                    />

                    <!-- Custom Angular Dropdown -->
                    <div class="relative">
                      <button
                        type="button"
                        (click)="toggleDropdown()"
                        class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors text-left flex justify-between items-center"
                      >
                        <span
                          [class.text-[#838383]]="
                            !forgotPasswordData.securityQuestion
                          "
                        >
                          {{
                            forgotPasswordData.securityQuestion ||
                              "Select Security Question"
                          }}
                        </span>
                        <svg
                          class="fill-current h-4 w-4 transform transition-transform"
                          [class.rotate-180]="isDropdownOpen"
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 0 20 20"
                        >
                          <path
                            d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"
                          />
                        </svg>
                      </button>

                      <div
                        *ngIf="isDropdownOpen"
                        class="absolute top-full left-0 w-full mt-1 bg-white border border-[#919194] rounded-md shadow-lg z-50 max-h-60 overflow-y-auto"
                      >
                        <div
                          *ngFor="let question of securityQuestions"
                          (click)="selectSecurityQuestion(question)"
                          class="px-4 py-2 hover:bg-gray-100 cursor-pointer transition-colors text-start"
                        >
                          {{ question }}
                        </div>
                      </div>
                    </div>

                    <input
                      type="text"
                      placeholder="Answer"
                      class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                      [(ngModel)]="forgotPasswordData.securityAnswer"
                      name="securityAnswer"
                      required
                    />
                  </div>

                  <div class="space-y-3">
                    <button
                      type="button"
                      (click)="nextStep()"
                      [disabled]="
                        !forgotPasswordData.identifier ||
                        !forgotPasswordData.securityQuestion ||
                        !forgotPasswordData.securityAnswer
                      "
                      [class]="
                        forgotPasswordData.identifier &&
                        forgotPasswordData.securityQuestion &&
                        forgotPasswordData.securityAnswer
                          ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer'
                          : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full cursor-not-allowed'
                      "
                    >
                      Submit
                    </button>
                    <button
                      type="button"
                      (click)="previousStep()"
                      class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                    >
                      Route Back
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 3: OTP Delivery Method -->
            <div *ngIf="currentStep === 3" class="w-full max-w-md">
              <div
                class="bg-white text-left rounded-xl p-6 shadow-lg mx-auto text-black"
              >
                <h2
                  class="text-[28px] text-[#101828] font-semibold mb-2 text-start"
                >
                  Forgot Password
                </h2>
                <p class="text-[16px] text-[#101828] mb-6 text-start">
                  Select either of the options below for OTP pin
                </p>

                <div class="space-y-6 mb-8">
                  <div
                    (click)="selectOtpMethod('phone')"
                    class="flex justify-between items-center gap-3 bg-[#D9D9D933] rounded-xl py-3 px-3 cursor-pointer hover:bg-gray-100 transition-colors"
                  >
                    <div class="flex items-center gap-4">
                      <ion-icon name="phone-portrait-outline"></ion-icon>
                      <div class="space-y-1">
                        <div>Phone Number</div>
                        <div>*********89</div>
                      </div>
                    </div>
                    <ion-icon name="chevron-forward-outline"></ion-icon>
                  </div>

                  <div
                    (click)="selectOtpMethod('email')"
                    class="flex justify-between items-center gap-3 bg-[#D9D9D933] rounded-xl py-3 px-3 cursor-pointer hover:bg-gray-100 transition-colors"
                  >
                    <div class="flex items-center gap-4">
                      <ion-icon name="mail-outline"></ion-icon>
                      <div class="space-y-1">
                        <div>Email Address</div>
                        <div>lo*****89@gmail.com</div>
                      </div>
                    </div>
                    <ion-icon name="chevron-forward-outline"></ion-icon>
                  </div>
                </div>

                <button
                  type="button"
                  (click)="previousStep()"
                  class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                >
                  Route Back
                </button>
              </div>
            </div>

            <!-- Step 4: Email Input -->
            <div
              *ngIf="
                currentStep === 4 && forgotPasswordData.otpMethod === 'email'
              "
              class="w-full max-w-md"
            >
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <h2
                  class="text-[28px] text-[#101828] font-semibold mb-2 text-start"
                >
                  Input email address
                </h2>
                <p class="text-[16px] text-[#101828] mb-6">
                  Input the email address registered with your account
                </p>

                <div class="space-y-6">
                  <div class="space-y-2">
                    <label for="email" class="text-start flex flex-col"
                      >Enter your Email</label
                    >
                    <input
                      type="email"
                      id="email"
                      placeholder="e.g chidi191@gmail.com"
                      class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                      [(ngModel)]="forgotPasswordData.email"
                      name="email"
                      required
                    />
                  </div>

                  <div class="space-y-3">
                    <button
                      type="button"
                      (click)="sendOtp()"
                      [disabled]="!forgotPasswordData.email"
                      [class]="
                        forgotPasswordData.email
                          ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer'
                          : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full cursor-not-allowed'
                      "
                    >
                      Proceed
                    </button>
                    <button
                      type="button"
                      (click)="previousStep()"
                      class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                    >
                      Route Back
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 4: Phone Input -->
            <div
              *ngIf="
                currentStep === 4 && forgotPasswordData.otpMethod === 'phone'
              "
              class="w-full max-w-md"
            >
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <h2
                  class="text-[28px] text-[#101828] font-semibold mb-2 text-start"
                >
                  Input Phone Number
                </h2>
                <p class="text-[16px] text-[#101828] mb-6 text-start">
                  Input the phone number registered with your account
                </p>

                <div class="space-y-6">
                  <div class="space-y-2">
                    <label for="phone " class="text-start flex flex-col"
                      >Enter your Phone Number</label
                    >
                    <input
                      type="tel"
                      id="phone"
                      placeholder="e.g 090123423212"
                      class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                      [(ngModel)]="forgotPasswordData.phone"
                      name="phone"
                      required
                    />
                  </div>

                  <div class="space-y-3">
                    <button
                      type="button"
                      (click)="sendOtp()"
                      [disabled]="!forgotPasswordData.phone"
                      [class]="
                        forgotPasswordData.phone
                          ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer'
                          : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full cursor-not-allowed'
                      "
                    >
                      Proceed
                    </button>
                    <button
                      type="button"
                      (click)="previousStep()"
                      class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                    >
                      Route Back
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 5: OTP Verification -->
            <div *ngIf="currentStep === 5" class="w-full max-w-md">
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <h2
                  class="text-[28px] text-[#101828] font-semibold mb-2 text-start"
                >
                  Input OTP
                </h2>

                <form class="space-y-6">
                  <!-- OTP Sent Message -->
                  <p
                    *ngIf="forgotPasswordData.otpMethod === 'email'"
                    class="text-[12px] px-1 text-[#101828] text-start"
                  >
                    OTP has been sent to {{ maskedEmail }}
                  </p>
                  <p
                    *ngIf="forgotPasswordData.otpMethod === 'phone'"
                    class="text-[12px] px-1 text-[#101828] text-start"
                  >
                    OTP has been sent to your registered phone number
                  </p>

                  <!-- OTP Input Boxes -->
                  <div class="flex justify-center gap-3 my-6">
                    <input
                      *ngFor="let box of otpBoxes; let i = index"
                      type="text"
                      maxlength="1"
                      inputmode="numeric"
                      class="w-16 h-16 text-[40px] text-center border border-[#D0D5DD] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#101828] placeholder:text-[#D0D5DD] placeholder:text-[48px]"
                      [(ngModel)]="otpValues[i]"
                      (input)="onOtpInput($event, i)"
                      (keydown)="onOtpKeyDown($event, i)"
                      [name]="'otp-' + i"
                    />
                  </div>

                  <!-- Countdown & Resend -->
                  <p class="text-sm text-[#000000] text-center">
                    <span *ngIf="countdown > 0">
                      Resend available in {{ countdown }}s
                    </span>
                    <button
                      *ngIf="countdown === 0"
                      type="button"
                      (click)="resendOtp()"
                      class="text-[#101828] font-medium hover:underline"
                    >
                      Resend OTP
                    </button>
                  </p>

                  <!-- Action Buttons -->
                  <div class="mt-6 space-y-3">
                    <button
                      type="button"
                      (click)="verifyOtp()"
                      [disabled]="!isOtpComplete"
                      [class]="
                        isOtpComplete
                          ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer'
                          : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full cursor-not-allowed'
                      "
                    >
                      Proceed
                    </button>
                    <button
                      type="button"
                      (click)="previousStep()"
                      class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                    >
                      Route Back
                    </button>
                  </div>
                </form>
              </div>
            </div>

            <!-- Step 6: Create New Password -->
            <div *ngIf="currentStep === 6" class="w-full max-w-md">
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <h2
                  class="text-[28px] text-[#101828] font-semibold mb-6 text-start"
                >
                  Create a New Password
                </h2>

                <div class="space-y-6">
                  <div class="space-y-6">
                    <div class="space-y-2">
                      <label for="newPassword text-start flex flex-col"
                        >Create a Password</label
                      >
                      <input
                        type="password"
                        id="newPassword"
                        placeholder="Enter password"
                        class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                        [(ngModel)]="forgotPasswordData.newPassword"
                        name="newPassword"
                        required
                        minlength="6"
                      />
                    </div>

                    <div class="space-y-2">
                      <label for="confirmPassword text-start flex flex-col"
                        >Confirm Password</label
                      >
                      <input
                        type="password"
                        id="confirmPassword"
                        placeholder="Re-enter your password"
                        class="w-full border border-[#919194] bg-[#EBEBEB] text-[#000000] placeholder:text-[#838383] rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-md transition-colors"
                        [(ngModel)]="forgotPasswordData.confirmPassword"
                        name="confirmPassword"
                        required
                        minlength="6"
                      />
                    </div>
                    <div
                      *ngIf="
                        forgotPasswordData.newPassword &&
                        forgotPasswordData.confirmPassword &&
                        forgotPasswordData.newPassword !==
                          forgotPasswordData.confirmPassword
                      "
                      class="text-red-500 text-sm text-start"
                    >
                      Passwords do not match
                    </div>
                  </div>

                  <div class="space-y-3">
                    <button
                      type="button"
                      (click)="updatePassword()"
                      [disabled]="
                        !forgotPasswordData.newPassword ||
                        !forgotPasswordData.confirmPassword ||
                        forgotPasswordData.newPassword !==
                          forgotPasswordData.confirmPassword
                      "
                      [class]="
                        forgotPasswordData.newPassword &&
                        forgotPasswordData.confirmPassword &&
                        forgotPasswordData.newPassword ===
                          forgotPasswordData.confirmPassword
                          ? 'bg-[#101828] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer'
                          : 'bg-[#CDD5DF] text-[16px] rounded-lg text-white py-3 w-full cursor-not-allowed'
                      "
                    >
                      Submit
                    </button>
                    <button
                      type="button"
                      (click)="previousStep()"
                      class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                    >
                      Route Back
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 7: Success -->
            <div *ngIf="currentStep === 7" class="w-full max-w-md">
              <div class="bg-white rounded-xl p-6 shadow-lg mx-auto text-black">
                <div class="items-center flex flex-col mb-6">
                  <img [src]="images.VerifiedIconUpdateProfile" alt="Success" />
                  <div class="space-y-3 text-center">
                    <p class="text-[#101828] text-[18px] font-semibold">
                      Password Created Successfully
                    </p>
                    <p class="text-[#667085] text-[14px]">
                      You have successfully created a new password kindly
                      proceed to login.
                    </p>
                  </div>
                </div>

                <div class="space-y-3">
                  <button
                    type="button"
                    (click)="goToLogin()"
                    class="bg-[#057A55] text-[16px] rounded-lg text-white py-3 w-full cursor-pointer"
                  >
                    Login
                  </button>
                  <button
                    type="button"
                    (click)="cancel()"
                    class="border border-gray-300 text-[16px] rounded-lg text-[#101828] py-3 w-full cursor-pointer"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          </form>
        </ion-col>
      </ion-row>

      <ion-row class="flex justify-center items-center bg-transparent">
        <ion-col class="text-white text-center"></ion-col>
      </ion-row>

      <ion-row class="flex justify-center items-center bg-transparent">
        <ion-col class="text-white text-center"></ion-col>
      </ion-row>
    </ion-grid>
  </ion-content>
</body>
