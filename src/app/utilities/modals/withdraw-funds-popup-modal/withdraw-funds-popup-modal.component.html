<ion-header>
  <!-- HEADER -->
  <div
    class="logcomplainModalBG flex justify-between items-center px-4 py-3 border-b flex-shrink-0"
  >
    <h2 class="text-lg font-bold text-white">Fund Withdrawal Form</h2>
    <button (click)="closeModal()" class="text-white hover:text-gray-700">
      ✕
    </button>
  </div>
</ion-header>

<ion-content class="ion-padding">
  <form action="">
    <!-- Info Note -->
    <div
      class="flex items-center gap-3 mb-3 bg-[#CDD5DF33] border border-[#33333333] rounded-xl py-4 px-6 mt-[4%]"
    >
      <span class="font-normal text-[16px] leading-tight text-[#444444]">
        Withdraw available funds for from your wallet to your designated bank
        account
      </span>
    </div>

    <div class="space-y-4 mt-6">
      <!-- Bank Dropdown -->
      <div class="relative w-[]">
        <div
          class="border border-[#D9DCE5] rounded-md px-4 py-4 bg-[#F6F6F6] flex justify-between items-center cursor-pointer"
          (click)="!isLoadingBanks && toggleBankDropdown()"
        >
          <span class="text-[#101828] text-[14px]">
            <span *ngIf="isLoadingBanks">Loading banks...</span>
            <span *ngIf="!isLoadingBanks && !selectedBank">Select NUBAN Bank</span>
            <span *ngIf="!isLoadingBanks && selectedBank">{{ selectedBank }}</span>
          </span>
          <ion-icon
            *ngIf="!isLoadingBanks"
            [name]="
              isBankDropdownOpen ? 'chevron-up-outline' : 'chevron-down-outline'
            "
          ></ion-icon>
          <ion-icon
            *ngIf="isLoadingBanks"
            name="sync-outline"
            class="animate-spin"
          ></ion-icon>
        </div>
        <div
          *ngIf="isBankDropdownOpen && !isLoadingBanks"
          class="absolute mt-2 bg-white border rounded-md shadow-md w-full z-10 overflow-y-auto max-h-60"
        >
          <p
            *ngFor="let bank of bankNames"
            class="px-4 py-2 hover:bg-gray-100 cursor-pointer"
            (click)="selectBank(bank)"
          >
            {{ bank }}
          </p>
          <p
            *ngIf="bankNames.length === 0"
            class="px-4 py-2 text-gray-500 text-center"
          >
            No banks available
          </p>
        </div>
      </div>
    </div>

    <!-- Account -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Input Account Number</label>
      <input
        type="text"
        [(ngModel)]="accountNumber"
        (ngModelChange)="handleAcctNum($event)"
        name="accountNumber"
        placeholder="3056578914"
        class="border border-[#D9DCE5] px-3 py-4 w-full rounded-lg bg-white placeholder:text-gray-300"
      />
      <small *ngIf="isValidAcctNum === true" class="text-blue-600">✅ {{validationProps.fullName}} </small>
      <small *ngIf="isValidAcctNum === 'processing'" class="text-yellow-500">processing... ✍️</small>
      <small *ngIf="isValidAcctNum === false" class="text-red-500">❌ This Account Number does not exist!</small>
    </div>

    <!-- Amount -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Input Amount to Withdraw</label>
      <input
        type="number"
        [(ngModel)]="amount"
        name="withdrawAmount"
        placeholder="₦ 700,000"
        class="border border-[#D9DCE5] px-3 py-4 w-full rounded-lg bg-white placeholder:text-gray-300"
      />
    </div>

    <!-- Info Note -->
    <div
      class="flex items-center gap-3 mb-3 bg-[#DDE3EC] border border-[#A3AFE3] rounded-xl py-4 px-6 mt-[10%]"
    >
      <ion-icon
        class="h-7 w-[15%] text-blue-700"
        name="information-circle"
      ></ion-icon>
      <span class="font-normal text-[16px] leading-tight text-[#1E4E99]">
        Important!: Due to bank Charges, a 200.00 charge shall be deducted from
        this transaction.
      </span>
    </div>

    <!-- Agreement -->
    <div class="flex items-center gap-4 text-[#101828] mt-8">
      <input type="checkbox" [(ngModel)]="agreed" name="agreed" />
      <div>
        I agree with <span class="text-[#0033FF]">terms and conditions</span>
      </div>
    </div>
  </form>

  <!-- Submit Button -->
  <div class="bg-white mt-10 pt-2 pb-16 flex justify-end">
    <button
      (click)="submitWithdrawal()"
      [disabled]="isLoadingBanks"
      class="px-4 py-2 w-full text-center bg-gray-800 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      <span *ngIf="!isLoadingBanks">Create Fund Withdrawal</span>
      <span *ngIf="isLoadingBanks">Loading banks...</span>
    </button>
  </div>
</ion-content>
