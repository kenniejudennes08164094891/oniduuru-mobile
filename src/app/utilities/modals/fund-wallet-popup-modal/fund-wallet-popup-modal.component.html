<ion-header>
  <!-- HEADER -->
  <div
    class="logcomplainModalBG flex justify-between items-center px-4 py-3 border-b flex-shrink-0"
  >
    <h2 class="text-lg font-bold text-white">Funds Deposit Form</h2>
    <button (click)="closeModal()" class="text-white hover:text-gray-700">
      ✕
    </button>
  </div>
</ion-header>

<ion-content class="ion-padding">
  <form #depositForm="ngForm">
    <div class="flex justify-between items-center gap-4 mt-6 px-10">
      <label class="flex items-center space-x-2">
        <input
          type="radio"
          name="fundType"
          value="Fund Self"
          [(ngModel)]="fundType"
          (change)="onFundTypeChangeEvent($event)"
        />
        <span>Fund Self</span>
      </label>

      <label class="flex items-center space-x-2">
        <input
          type="radio"
          name="fundType"
          value="Fund Others"
          [(ngModel)]="fundType"
          (change)="onFundTypeChangeEvent($event)"
        />
        <span>Fund Others</span>
      </label>
    </div>
    
    <!-- Fund Type Error -->
    <p *ngIf="validationErrors.fundType" class="text-red-500 text-sm mt-1 ml-4">
      {{ validationErrors.fundType }}
    </p>

    <!-- Info Note -->
    <div
      class="flex items-center gap-3 mb-3 bg-[#CDD5DF33] border border-[#33333333] rounded-xl py-4 px-6 mt-[10%]"
    >
      <ion-icon class="h-7 w-" name="information-circle-outline"></ion-icon>
      <span class="font-normal text-[16px] leading-tight text-[#444444]">
        NB: You'd be redirected to Paystack's Payment Gateway to complete your
        fund deposit.
      </span>
    </div>

    <!-- Amount -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Amount *</label>
      <input
        type="text"
        [ngModel]="formattedAmount"
        (ngModelChange)="onAmountChange($event)"
        name="amount"
        placeholder="₦ 45,000"
        required
        class="border px-3 py-4 w-full rounded-lg bg-white placeholder:text-gray-300"
        [ngClass]="validationErrors.amount ? 'border-red-500' : 'border-[#D9DCE5]'"
        (blur)="onAmountBlur()"
      />
      <p *ngIf="validationErrors.amount" class="text-red-500 text-sm">
        {{ validationErrors.amount }}
      </p>
      <p *ngIf="!validationErrors.amount && !amount && formSubmitted" class="text-red-500 text-sm">
        Amount is required.
      </p>
    </div>

    <!-- Wallet Acc -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Designated Wallet Account *</label>
      <input
        type="text"
        [ngModel]="walletAccNo"
        (ngModelChange)="onWalletAccNoChange($event)"
        name="walletAcc"
        placeholder="3056578914"
        required
        maxlength="11"
        class="border px-3 py-4 w-full rounded-lg bg-white placeholder:text-gray-300"
        [ngClass]="validationErrors.walletAccNo ? 'border-red-500' : 'border-[#D9DCE5]'"
        inputmode="numeric"
        pattern="[0-9]*"
      />
      <p *ngIf="validationErrors.walletAccNo" class="text-red-500 text-sm">
        {{ validationErrors.walletAccNo }}
      </p>
      <p *ngIf="!validationErrors.walletAccNo && !walletAccNo && formSubmitted" class="text-red-500 text-sm">
        Wallet account number is required.
      </p>
    </div>

    <!-- Wallet Name -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Designated Wallet Name *</label>
      <input
        type="text"
        [ngModel]="walletName"
        (ngModelChange)="onWalletNameChange($event)"
        name="walletName"
        placeholder="Viki West"
        required
        maxlength="50"
        class="border px-3 py-4 w-full rounded-lg bg-white placeholder:text-gray-300"
        [ngClass]="validationErrors.walletName ? 'border-red-500' : 'border-[#D9DCE5]'"
      />
      <p *ngIf="validationErrors.walletName" class="text-red-500 text-sm">
        {{ validationErrors.walletName }}
      </p>
      <p *ngIf="!validationErrors.walletName && !walletName && formSubmitted" class="text-red-500 text-sm">
        Wallet name is required.
      </p>
    </div>

    <!-- Reason OPTIONAL -->
    <div class="space-y-2 mt-8">
      <label class="text-[#344054] text-[14px]">Reason (Optional)</label>
      <textarea
        [ngModel]="reason"
        (ngModelChange)="onReasonChange($event)"
        name="reason"
        placeholder="Write your thoughts here..."
        maxlength="500"
        class="border px-3 pt-2 pb-10 w-full rounded-lg bg-white placeholder:text-gray-300"
        [ngClass]="validationErrors.reason ? 'border-red-500' : 'border-[#D9DCE5]'"
      ></textarea>
      <p *ngIf="validationErrors.reason" class="text-red-500 text-sm">
        {{ validationErrors.reason }}
      </p>
      <div class="flex justify-between text-xs text-gray-500">
        <span>{{ reason.length || '' }}/500 characters</span>
        <span *ngIf="reason">Optional</span>
      </div>
    </div>

    <!-- Terms -->
    <div class="flex items-center gap-4 text-[#101828] mt-8">
      <input 
        type="checkbox" 
        [ngModel]="agreed" 
        (ngModelChange)="onAgreedChange()"
        name="agreed" 
        id="termsCheckbox"
      />
      <label for="termsCheckbox" class="cursor-pointer">
        I agree with
        <span class="text-[#0033FF] cursor-pointer hover:underline">terms and conditions</span>
      </label>
    </div>
    <p *ngIf="validationErrors.agreed" class="text-red-500 text-sm mt-1 ml-6">
      {{ validationErrors.agreed }}
    </p>
  </form>

  <div class="bg-white mt-10 pt-2 pb-16">
    <button
      class="px-4 py-3 w-full items-center text-center bg-gray-800 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
      (click)="submitDeposit()"
      [disabled]="isProcessing"
    >
      <span *ngIf="!isProcessing">Create Fund Deposit</span>
      <span *ngIf="isProcessing" class="flex items-center justify-center gap-2">
        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
        </svg>
        Processing...
      </span>
    </button>
    
    <!-- Transaction charge info for Fund Others -->
    <div *ngIf="fundType === 'Fund Others' && amount && amount > 0" class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
      <p class="text-sm text-blue-800">
        <strong>Note:</strong> A transaction charge will be applied for funding others' wallets.
      </p>
    </div>
  </div>
</ion-content>